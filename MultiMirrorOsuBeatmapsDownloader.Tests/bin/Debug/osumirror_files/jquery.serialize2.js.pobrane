// All these things are for clean query string FFFFFF
(function($) {

    $.fn.serialize2 = function(options, glue)
    {
        glue = glue || ',';

        var query = this.serialize();
        $.each(options, function(i, name)
        {
            var key = '&' + name + '=';
            var params = query.split(key);
            query = [ params.shift(), params.join(glue) ].join(key);
        });

        return query;
    };

    /** deserialize param string, then apply to Form
     * @param query {String} serialized param by $.fn.serialize2
     * @param options {Array} params that need to be splitted
     * @param splitter {String}
     * @link $.fn.deserialize
     */
    $.fn.deserialize2 = function(query, options, splitter)
    {
        splitter = splitter || ',';

        var re = new RegExp('(&?(?:' + options.join('|') + ')=)([^&]*)', 'g');
        query = query.replace(re, function(s, k, v)
        {
            return k + v.split(splitter).join('&' + k);
        });

        return this.deserialize(query.replace(/&+/g, '&'));
    };

})(jQuery);